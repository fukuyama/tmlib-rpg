# ダメージ計算とかのメモ

## Attack Context (atkcx)

攻撃側のダメージ源となる情報
物理ダメージ１００とか、魔法ダメージ５０とか、炎ダメージ２００など

スキル（通常攻撃を含む）により生成される。

## Defence Context (defcx)

防御側の属性情報、属性攻撃防御に反映される。

## ダメージ処理

- スキルによるダメージを計算し atkcx を作成

スキルごとの計算式により算出。
攻撃側バトラー、防御側バトラーのそれぞれの能力値（武器防具等の装備とステートによるブーストを含む能力値）から計算

- 防御側アクターの defcx を作成

アクターから作成する。アクター自身が元々持っている物、ステートにより一時的な物、装備等による物など。

- atkcx に、ステートによる攻撃属性変化を行う。

物理ダメージアップ、炎攻撃属性付加等

## 例

- 通常攻撃

スキル通常攻撃で、攻撃側の攻撃力と防御側の防御力から atkcx を作成
ダメージを適用

- ゾンビキラー（アンデット属性に対して２倍ダメージ）の武器

スキル通常攻撃で、攻撃側の攻撃力と防御側の防御力から atkcx を作成（ステートでの状態変化も反映）
防御側の defcx を作成（ステートからも取得）
atkcx と defcx から攻撃ダメージの決定、ステータス（defcx の属性が合っていれば、武器ステータスのアンデット属性に対して２倍ダメージを適用）
defcx から防御ダメージの決定
ダメージを適用

