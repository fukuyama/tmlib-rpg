
# TODO

 - セーブ＆ロードをそろそろ
  - Item
   - Weapon
   - Armor
  - Skill
  - Actor
  - Party
 - アイテムとスキルの実装を改造する！
  - ItemとSkillは、基本的に同じ基底クラスにしたい
   - Effect が基底クラス
   - 派生とか使わない方が良いかも？
 - 戦闘シーンの作成
  - ターン戦闘
  - 行動順は、すばやさ順
   - コマンド入力は、ターン前じゃなくて、順番がきてから。
  - アニメーションを作成しないと…
 - tmlib.js CDN https://cdnjs.com/libraries/tmlib.js

# ダメージ計算とかのメモ


## Attack Context (atkcx)

攻撃側のダメージ源となる情報
物理ダメージ１００とか、魔法ダメージ５０とか、炎ダメージ２００など

スキル（通常攻撃を含む）により生成される。

## Defence Context (defcx)

防御側の属性情報、属性攻撃防御に反映される。

## ダメージ処理

- スキルによるダメージを計算し atkcx を作成

スキルごとの計算式により算出。
攻撃側バトラー、防御側バトラーのそれぞれの能力値（武器防具等の装備とステートによるブーストを含む能力値）から計算

- 防御側アクターの defcx を作成

アクターから作成する。アクター自身が元々持っている物、ステートにより一時的な物、装備等による物など。

- atkcx に、ステートによる攻撃属性変化を行う。

物理ダメージアップ、炎攻撃属性付加等

## 例

- 通常攻撃

スキル通常攻撃で、攻撃側の攻撃力と防御側の防御力から atkcx を作成
ダメージを適用

- ゾンビキラー（アンデット属性に対して２倍ダメージ）の武器

スキル通常攻撃で、攻撃側の攻撃力（アクター能力＋武器能力）と防御側（アクター能力＋防具能力）の防御力から atkcx を作成（ステートでの状態変化も反映）
防御側の defcx を作成（ステートからも取得）
atkcx と defcx から攻撃ダメージの決定、ステータス（defcx の属性が合っていれば、武器ステータスのアンデット属性に対して２倍ダメージを適用）
defcx から防御ダメージの決定
ダメージを適用

- 魔法

スキル攻撃魔法で、攻撃側の魔法攻撃力（アクター能力＋魔法能力）と防御側の魔法防御力（アクター能力＋防具能力）から atkcx を作成（ステートでの状態変化も反映）
ＭＰ消費はダメージ処理とは別で対応
防御側の defcx を作成（ステートからも取得）
atkcx と defcx から攻撃ダメージの決定、ステータス（defcx の属性が合っていれば、それらの影響を適用）
defcx から防御ダメージの決定
ダメージを適用

- 攻撃

ＭＰを消費して武器による特殊な攻撃は必要？フレームワーク的には必要か・・・
魔法とか呪文と同じ気がするけれど・・・

２回攻撃とか範囲攻撃は、ダメージ処理とは別で対応しないと

